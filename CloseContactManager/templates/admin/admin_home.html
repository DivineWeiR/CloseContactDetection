{% extends 'admin/base_url.html' %}
{% load static %}
{# 页面内容 #}
{% block content %}
    <!-- Orders -->
    <div class="orders">
        <div class="row">
            <div class="col-xl-9">
                <div class="card">
                    <div class="card-body">
                        <h4 class="box-title inline-block">管辖区域：<span
                                class="color-gray">{{ administrative_name }}</span></h4>
                    </div>
                </div>
            </div>
            <div class="col-xl-3">
                <div class="card">
                    <div class="card-body">
                        <h4 class="box-title inline-block">当前疫情防控等级：<span
                                class="color-red">{{ disease_level }}</span></h4>
                        <div class="btn-group pull-right">

                            <button class="btn btn-outline-success dropdown-toggle btn-sm"
                                    data-toggle="dropdown">修改防控等级
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu bg-white" role="menu">
                                <li>
                                    <a href="/admin/update_disease_level?new_level=1" class="dropdown-a">
                                        调整为1级
                                    </a>
                                </li>
                                <li>
                                    <a href="/admin/update_disease_level?new_level=2" class="dropdown-a"
                                       onclick="card_shift('0')">
                                        调整为2级
                                    </a>
                                </li>
                                <li>
                                    <a href="/admin/update_disease_level?new_level=3" class="dropdown-a"
                                       onclick="card_shift('1')">
                                        调整为3级
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-0">昨日+<span
                                            class="count">{{ new_counts.0 }}</span></div>
                                    <div class="stat-text fg-color-0"><span
                                            class="count">{{ total_counts.0 }}</span></div>
                                    <div class="stat-heading">健康用户</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-1">昨日+<span
                                            class="count">{{ new_counts.1 }}</span></div>
                                    <div class="stat-text fg-color-1"><span
                                            class="count">{{ total_counts.1 }}</span></div>
                                    <div class="stat-heading">低风险-密切接触者</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-2">昨日+<span
                                            class="count">{{ new_counts.2 }}</span></div>
                                    <div class="stat-text fg-color-2"><span
                                            class="count">{{ total_counts.2 }}</span></div>
                                    <div class="stat-heading">中风险-密切接触者</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-3">昨日+<span
                                            class="count">{{ new_counts.3 }}</span></div>
                                    <div class="stat-text fg-color-3"><span
                                            class="count">{{ total_counts.3 }}</span></div>
                                    <div class="stat-heading">高风险-密切接触者</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-4">昨日+<span
                                            class="count">{{ new_counts.4 }}</span></div>
                                    <div class="stat-text fg-color-4"><span
                                            class="count">{{ total_counts.4 }}</span></div>
                                    <div class="stat-heading">疑似病例</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-5">昨日+<span
                                            class="count">{{ new_counts.5 }}</span></div>
                                    <div class="stat-text fg-color-5"><span
                                            class="count">{{ total_counts.5 }}</span></div>
                                    <div class="stat-heading">确诊病例</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-lg-1-7 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div class="stat-widget-five">
                            <div class="stat-content">
                                <div class="text-left dib">
                                    <div class="stat-text-sub fg-color-6">昨日+<span
                                            class="count">{{ new_counts.6 }}</span></div>
                                    <div class="stat-text fg-color-6"><span
                                            class="count">{{ total_counts.6 }}</span></div>
                                    <div class="stat-heading">无症状感染者</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row equal-height-container">
            <div class="match-height col-xl-10">
                <div class="card">
                    <div class="card-body">
                        <h4 class="box-title">各用户状态情况 </h4>
                    </div>
                    <div class="card-body-- text-center">
                        <div class="row no-margin">
                            <div class="chart-container ov-h col-lg-7 col-md-12" id="barchart-status-box">
                                <div id="barchart-status" class="chart-body chart"></div>
                            </div>
                            <div class="chart-container ov-h col-lg-5 col-md-12" id="piechart-status-box">
                                <div id="flotPie1" class="chart-body chart"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body"></div>
                </div> <!-- /.card -->
            </div>  <!-- /.col-lg-8 -->
            <div class="match-height col-xl-2">
                <div class="card">
                    <div class="card-body">
                        <h4 class="box-title">个人求助和举报信息 </h4>
                    </div>
                    <div class="card-body-- text-center">
                        <div class="chart-container ov-h" id="barchart-help-report-box">
                            <div class="col-md-12">
                                <div id="barchart-help-report" class="chart-body chart"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body"></div>
                </div> <!-- /.card -->
            </div>  <!-- /.col-lg-8 -->


        </div>
    </div>
    <!-- /.orders -->

    <!-- Scripts -->
    <script src="{% static 'js/jquery.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
    <script src="{% static '/js/main.js' %}"></script>
    <script src="{% static 'js/echarts.min.js' %}"></script>
    <script src="{% static 'js/myECharts.js' %}"></script>

    <!--Local Stuff-->
    <script>

        var $ = window.jQuery;
        draw_ring_chart("flotPie1", {{ legend_data|safe }}, {{ series_data|safe }}, {{ color_data|safe }});
        draw_stacked_bar_chart("barchart-status", {{ legend_data|safe }}, {{ total_data|safe }}, {{ new_data|safe }});
        draw_stacked_bar_chart("barchart-help-report", {{ legend_data_hr|safe }}, {{ total_hr_data|safe }}, {{ new_hr_data|safe }});
        // apply matchHeight to each item container's items
        $('.equal-height-container').each(function () {
            $(this).children('.match-height').children('.card').matchHeight(true);
        });

        window.onresize = function () {

            chartsResize($('#barchart-help-report-box'), $('#barchart-help-report'));
            chartsResize($('#barchart-status-box'), $('#barchart-status'));
            chartsResize($('#piechart-status-box'), $('#piechart-status'));

        };
        $('#admin-home').addClass("active");

    </script>
{% endblock %}
